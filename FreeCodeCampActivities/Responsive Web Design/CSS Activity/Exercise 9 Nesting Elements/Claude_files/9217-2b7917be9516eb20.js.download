"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9217],{80028:function(e,t,n){n.d(t,{$H:function(){return useCreateNewConversation},$Y:function(){return useCreateConversationMutation},Ke:function(){return useMessageFeedbackMutation},PD:function(){return useShareConversationMutation},QR:function(){return useGetConversationsQuery},V_:function(){return useDeleteSharedConversationMutation},W:function(){return useRenameChatMutation},hA:function(){return useGetConversationQuery},j1:function(){return useDeleteConversationMutation},j7:function(){return useGenerateChatTitleMutation},lG:function(){return useUpdateConversationMessagesMutation},lg:function(){return fullMessageContent}});var a=n(86211),r=n(22809),i=n(99865),l=n(82083),s=n(10040),o=n(64677),u=n.n(o),c=n(32859),d=n(7653);let useGetConversationQuery=function(e){let{suppressError:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{activeOrganization:n}=(0,r.t)(),l=null==n?void 0:n.uuid;return(0,a.WE)("/api/organizations/".concat(null!=l?l:"","/chat_conversations/").concat(e),{queryKey:[i.ph,{orgUUID:l},{uuid:e}],enabled:!!l,select:e=>({...e,chat_messages:u()(e.chat_messages,"index").map(e=>({...e,is_edited:e.is_edited||!!e.edited_at}))}),meta:{noToast:t}})},useGetConversationsQuery=()=>{let{activeOrganization:e}=(0,r.t)(),t=null==e?void 0:e.uuid;return(0,a.WE)("/api/organizations/".concat(null!=t?t:"","/chat_conversations"),{queryKey:[i.tv,{orgUUID:t}],staleTime:3e5,enabled:!!t,select:e=>u()(e,e=>new Date(e.updated_at)).reverse()})},useCreateNewConversation=e=>{let{mutate:t}=useCreateConversationMutation(),n=(0,c.useRouter)();return(0,d.useCallback)(()=>{let a=(0,l.H)();t({uuid:a,name:""}),n[e]("/chat/".concat(a))},[t,n,e])},useCreateConversationMutation=()=>{let{activeOrganization:e}=(0,r.t)(),t=null==e?void 0:e.uuid,n=(0,s.useQueryClient)(),l=[i.tv,{orgUUID:t}],getConvQueryKey=e=>[i.ph,{orgUUID:t},{uuid:e}];return(0,a.uC)("/api/organizations/".concat(null!=t?t:"","/chat_conversations"),"POST",{enabled:!!t,async onMutate(e){let t=getConvQueryKey(e.uuid),a={summary:"",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),...e};await Promise.all([n.cancelQueries({queryKey:l}),n.cancelQueries({queryKey:t})]),n.setQueryData(l,e=>e&&[a,...e]),n.setQueryData(t,e=>({...e||{},...a,chat_messages:(null==e?void 0:e.chat_messages)||[]}))},onSuccess:e=>{n.setQueryData(l,t=>{if(!t)return;let n=t.findIndex(t=>t.uuid===e.uuid);if(-1===n)return t;let a=[...t];return a.splice(n,1,e),a}),n.setQueryData(getConvQueryKey(e.uuid),t=>({...t||{},...e,chat_messages:(null==t?void 0:t.chat_messages)||[]}))},onError(e,t){n.setQueryData(l,e=>null==e?void 0:e.filter(e=>e.uuid!==t.uuid)),n.setQueryData(getConvQueryKey(t.uuid),void 0)}})},useDeleteConversationMutation=()=>{let{activeOrganization:e}=(0,r.t)(),t=null==e?void 0:e.uuid,n=(0,s.useQueryClient)();return(0,a.Ne)(e=>"/api/organizations/".concat(null!=t?t:"","/chat_conversations/").concat(e),"DELETE",(e,t)=>{if(!t)return[];let n=t.findIndex(t=>t.uuid===e);if(!(n>-1))return t;{let e=[...t];return e.splice(n,1),e}},{enabled:!!t,queryKey:[i.tv,{orgUUID:t}],onSuccess:async(e,a)=>{await n.invalidateQueries([i.ph,{orgUUID:t},{uuid:a}])}})},useUpdateConversationMessagesMutation=e=>{let{activeOrganization:t}=(0,r.t)(),n=null==t?void 0:t.uuid,l=(0,s.useQueryClient)();return(0,a.Ne)("/api/organizations/".concat(null!=n?n:"","/chat_conversations/").concat(e),"PUT",(e,t)=>t?{...t,chat_messages:e.map((e,t)=>({created_at:new Date().toISOString(),index:t,text:e.text,sender:e.sender,attachments:[],is_edited:!0}))}:void 0,{enabled:!!n,queryKey:[i.ph,{orgUUID:n},{uuid:e}],transformVariables:e=>({messages:e.map((e,t)=>({index:t,text:e.text,sender:e.sender}))}),onSuccess(t){l.setQueryData([i.ph,{orgUUID:n},{uuid:e}],t)}})},useShareConversationMutation=e=>{let{activeOrganization:t}=(0,r.t)(),n=null==t?void 0:t.uuid;return(0,a.uC)("/api/organizations/".concat(n,"/chat_conversations/").concat(e,"/share"),"POST",{meta:{errorMessage:"There was an error while trying to share the converation. Please try again."}})},useDeleteSharedConversationMutation=e=>{let{activeOrganization:t}=(0,r.t)(),n=null==t?void 0:t.uuid;return(0,a.uC)("/api/organizations/".concat(n,"/share/").concat(e),"DELETE",{meta:{errorMessage:"There was an error while trying to delete the converation. Please try again."}})},useMessageFeedbackMutation=(e,t)=>{var n;let{activeOrganization:l}=(0,r.t)(),o=null==l?void 0:l.uuid,u=(0,s.useQueryClient)(),c=[i.ph,{orgUUID:o},{uuid:e}],updateChatFeedbackCache=e=>{u.setQueryData(c,n=>{if(!n)return;let a=n.chat_messages,r=a.findIndex(e=>e.uuid===t.uuid),i=[...a];return r>=0&&(i[r]={...i[r],chat_feedback:e}),{...n,chat_messages:i}})};return(0,a.uC)("/api/organizations/".concat(null!=o?o:"","/chat_conversations/").concat(e,"/chat_messages/").concat(null!==(n=t.uuid)&&void 0!==n?n:"","/chat_feedback"),t.chat_feedback?"PUT":"POST",{enabled:!!o,meta:{errorMessage:"We could not save your feedback. Please try again later."},onSuccess(e){updateChatFeedbackCache(e)},async onMutate(e){await u.cancelQueries({queryKey:c});let t=u.getQueryData(c);return updateChatFeedbackCache(e),{previousValue:t}},onError:(e,t,n)=>{(null==n?void 0:n.previousValue)&&u.setQueryData(c,n.previousValue)}})},useUpdateQueryCacheWithNewTitle=()=>{let e=(0,s.useQueryClient)(),{activeOrganization:t}=(0,r.t)(),n=null==t?void 0:t.uuid;return(0,d.useCallback)((t,a)=>{t&&(e.setQueryData([i.ph,{orgUUID:n},{uuid:t}],e=>e&&{...e,name:a}),e.setQueryData([i.tv,{orgUUID:n}],e=>null==e?void 0:e.map(e=>e.uuid!==t?e:{...e,name:a})))},[n,e])},useRenameChatMutation=e=>{let t=(0,s.useQueryClient)(),{activeOrganization:n}=(0,r.t)(),l=null==n?void 0:n.uuid,o=useUpdateQueryCacheWithNewTitle();return(0,a.uC)("/api/organizations/".concat(l,"/chat_conversations/").concat(e),"PUT",{onMutate:n=>{var a;let{name:r}=n,s=t.getQueryData([i.ph,{orgUUID:l},{uuid:e}]);return o(e,r),{oldTitle:null!==(a=null==s?void 0:s.name)&&void 0!==a?a:""}},onError(t,n,a){a&&o(e,a.oldTitle)}})},useGenerateChatTitleMutation=()=>{let e=useUpdateQueryCacheWithNewTitle();return(0,a.uC)("/api/generate_chat_title","POST",{onSuccess(t,n){let{title:a}=t,{conversation_uuid:r}=n;e(r,null!=a?a:"")},onError(){}})};function fullMessageContent(e){return e.text+e.attachments.map(e=>e.extracted_content).join(" ")}},82021:function(e,t,n){n.d(t,{YW:function(){return q},Hh:function(){return B},ZP:function(){return G},uV:function(){return useChatInputStorage},kw:function(){return useMessageLimit},YR:function(){return usePasteInterceptor},Xn:function(){return useTokenLimit}});var a=n(58882),r=n(27573),i=n(80028),l=n(58355),s=n(93352),o=n(22809),u=n(19981),c=n(30762),d=n(1811),m=n(55616),p=n(55880),f=n(33039),h=n(37653),g=n(36757),x=n(71407),v=n(75502),b=n(57405),y=n(53910),w=n(90794),j=n(95989),_=n(2056),C=n.n(_),k=n(7653),S=n(83127),P=n(85479),T=n(98771),N=n(42451),O=n(45852),Z=n(92647),M=n(59709),F=n(54181),E=n(74195),L=n(3660);let D=M.hj.create({name:"SnippetCommandParamPlaceholder",addOptions:()=>({snippetCommands:[]}),addProseMirrorPlugins(){let e=this.options;return[new b.Sy({key:new b.H$("SnippetCommandParamPlaceholder"),props:{decorations(t){let n=[];return t.doc.descendants((a,r)=>{if("mention"===a.type.name){var i;let l=e.snippetCommands.find(e=>e.label===a.attrs.id);if(!l)return;let s=t.doc.resolve(r+a.nodeSize),o=r+a.nodeSize+1;s.nodeAfter&&s.nodeAfter.isText&&(null===(i=s.nodeAfter.text)||void 0===i?void 0:i.trim())===""&&n.push(Z.p.widget(o,()=>{let e=document.createElement("span");return e.innerText=l.paramPlaceholder,e.className=L.Lt,e}));let u=t.doc.nodeSize;n.push(Z.p.inline(o,u,{class:L.Lt}))}}),Z.EH.create(t.doc,n)}}})]}}),U=M.hj.create({addKeyboardShortcuts:()=>({"Shift-Enter":e=>{let{editor:t}=e;return t.commands.enter(),t.commands.scrollIntoView(),!0}})}),CodeBlock=()=>(0,r.jsx)(y.T5,{className:"code-block",children:(0,r.jsx)("pre",{className:"block bg-stone-200 p-2 my-4 rounded-md",children:(0,r.jsx)(y.ms,{as:"code"})})}),useTipTap=e=>{let{input:t,setInput:n,placeholder:a,snippetCommands:r,extraEditorAttributes:i={}}=e,l=(0,L.k7)(r),s=[F.Z.configure({hardBreak:!1,codeBlock:!1}),T.Z.extend({addNodeView:()=>(0,y.fW)(CodeBlock)}).configure({lowlight:E.$}),U,O.Z.configure({placeholder:a,emptyEditorClass:"is-editor-empty before:!text-stone-400 before:whitespace-nowrap"}),D.configure({snippetCommands:r})],o=(0,L.Fy)(r),{value:u}=(0,S.useGate)("chat_editor_snippets");u&&s.push(N.ZP.configure({HTMLAttributes:{class:L.ms},suggestion:o}));let c=(0,y.jE)({editorProps:{attributes:{enterkeyhint:"enter",...i}},autofocus:!(0,f.t)()&&"end",extensions:s,content:t,onUpdate(e){let{editor:t}=e,a=t.isEmpty;n(l.turndown(t.getHTML())),a&&t.commands.focus("end")}}),d=(0,k.useCallback)(()=>{if(!c)return null;let e=null,t=c.state.doc;return t.descendants(t=>{if("mention"===t.type.name){let n=r.find(e=>e.label===t.attrs.id);n&&!e&&(e=n)}}),e},[c,r]);return{editor:c,getActiveSnippetCommand:d}};var z=n(90643),A=n(92577),R=n(5718),Q=n(53544),I=n(32683),W=n(45440),K=n(39547);function _templateObject(){let e=(0,a._)(["\n  w-full\n  @lg:w-fit\n  shrink-0\n  text-center\n"]);return _templateObject=function(){return e},e}function _templateObject1(){let e=(0,a._)(["\n  hover:underline\n  text-ant-primary\n  font-semibold\n"]);return _templateObject1=function(){return e},e}function _templateObject2(){let e=(0,a._)(["\n  font-normal\n  text-xs\n  text-stone-500\n  w-full\n  flex\n  flex-col\n  items-center\n  -translate-y-px\n  pl-1\n  pr-1\n  sm:flex-row\n  sm:justify-between\n"]);return _templateObject2=function(){return e},e}function _templateObject3(){let e=(0,a._)(["\n  relative\n  px-2 md:px-1\n"]);return _templateObject3=function(){return e},e}function _templateObject4(){let e=(0,a._)(["\n  padding-bottom: env(safe-area-inset-bottom, 0);\n"]);return _templateObject4=function(){return e},e}function _templateObject5(){let e=(0,a._)(["\n  relative\n  bg-bg-000\n  flex\n  gap-2\n  px-4\n  rounded-2xl\n  shadow-element\n"]);return _templateObject5=function(){return e},e}function _templateObject6(){let e=(0,a._)(["\n  absolute\n  inset-0\n  box-content\n  px-1\n  bg-bg-100/75\n  -z-10\n  backdrop-blur\n"]);return _templateObject6=function(){return e},e}function _templateObject7(){let e=(0,a._)(["\n    bottom: calc(env(safe-area-inset-bottom, 0) * -1);\n"]);return _templateObject7=function(){return e},e}function _templateObject8(){let e=(0,a._)(["\n  grid\n  grid-flow-col\n  gap-2\n  items-center\n"]);return _templateObject8=function(){return e},e}function _templateObject9(){let e=(0,a._)(["\n  grid-auto-columns: 2rem;\n"]);return _templateObject9=function(){return e},e}function _templateObject10(){let e=(0,a._)(["\n  flex\n  flex-wrap\n  gap-4\n  pb-4\n"]);return _templateObject10=function(){return e},e}function _templateObject11(){let e=(0,a._)(["\n  delay-100\n  duration-500\n  transition-all\n  inset-0\n  pointer-events-none\n  flex\n  -mt-2\n  pb-1\n  transition-opacity \n  absolute\n  inset-0\n  px-1\n  -z-10\n  pt-1\n  blur\n  translate-y-1\n  bg-bg-100\n  bottom-10\n  left-0\n  right-0\n"]);return _templateObject11=function(){return e},e}function _templateObject12(){let e=(0,a._)(["\n    flex\n    justify-center\n    items-center\n    -mt-2\n    pt-3\n    pb-1\n    relative\n    text-xs\n    z-auto\n    text-text-400\n  "]);return _templateObject12=function(){return e},e}function _templateObject13(){let e=(0,a._)(["\n    font-weight: 400;\n    font-size: 0.625rem;\n  "]);return _templateObject13=function(){return e},e}let B=35e3,pluralize=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"s";return"".concat(e," ").concat(t).concat(1===e?"":n)};var G=(0,k.forwardRef)(function(e,t){let{conversationUUID:n,send:a,isStreaming:l,testId:s,defaultMessage:o,conversationTokensSoFar:u,allowAttachments:c,extraShortcutsHint:m,isAtBottom:f}=e,{input:h,setInput:v,attachments:b,setAttachments:y}=useChatInputStorage(n,o),{data:j}=(0,i.hA)(n,{suppressError:!0}),_=(0,k.useCallback)(e=>{let t=null==j?void 0:j.chat_messages.find(t=>t.attachments.find(t=>t.extracted_content===e));return!!t},[j]),{exceededMessageLimitWarning:P,approachingMessageLimitWarning:T}=useMessageLimit(),{exceededTokenLimitWarning:N,willExceedTokenLimitWarning:O,slowResponseWarning:Z,messageTokenCount:M}=useTokenLimit({input:h,attachments:b,conversationTokensSoFar:u}),{value:F}=(0,S.useGate)("read_only_mode"),E=F&&(0,r.jsx)(ReadOnlyModeWarning,{}),L=(0,k.useCallback)(e=>{y(t=>t.filter((t,n)=>n!==e))},[y]),[D,U]=(0,k.useState)(!1),z=(0,k.useRef)(null);(0,k.useImperativeHandle)(t,()=>({setContent(e,t){var n;v(e),null===(n=z.current)||void 0===n||n.setContent(e),y(t)}}),[y,v]);let[A,R,W,K]=(0,Q.kS)({attachments:b,setAttachments:y,detectSameAttachment:_}),B=usePasteInterceptor(b,y,R),G=l||A||!!P||!!O||F,H=(0,k.useCallback)((e,t)=>{var n;G||""===e.trim()&&0===t.length||(a({prompt:e,attachments:t,messageTokenCount:M}),v(""),null===(n=z.current)||void 0===n||n.setContent(""),y([]))},[G,y,a,v,M]);(0,k.useLayoutEffect)(()=>{var e;null===(e=z.current)||void 0===e||e.focus()},[]);let V=T||O||Z,$=(0,I.p)(y,R),Y=isCompactMobile(),J=D&&f||V;return(0,r.jsxs)(X,{"data-testid":s,children:[(0,r.jsx)(er,{className:(0,w.Z)({"opacity-0":!J})}),V||(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:(0,w.Z)("pb-1 hidden md:block text-xs text-text-500 delay-100 duration-500 transition-opacity text-right pr-2",{"opacity-0":!J}),children:[(0,r.jsx)("strong",{children:"shift + ⏎"})," to add a new line",m&&(0,r.jsxs)(r.Fragment,{children:[", ",m]})]})}),(0,r.jsx)(ee,{onDrop:c?W:void 0,onPasteCapture:c?B:void 0,children:P||N||E||(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(q,{ref:z,input:h,setInput:v,placeholder:"Message Claude...",onSubmit:()=>{H(h,b)},attachments:b,onRemoveAttachment:L,snippetCommands:$,onFocus:()=>U(!0),onBlur:()=>U(!1),isFirstMessage:0===u}),(0,r.jsxs)(en,{children:[c&&K,(0,r.jsx)(d.Z,{disabled:G,onClick:()=>{H(h,b)},"aria-label":"Send Message",className:"aspect-square !px-1 !py-1 rounded-xl",children:(0,r.jsx)(g.Z,{className:"h-4 w-auto",weight:"fill"})})]})]})}),(0,r.jsxs)(ei,{children:[(0,r.jsx)(et,{}),(0,r.jsx)(x.Z,{className:"h-2.5"})," \xa0",(0,r.jsx)(p.Z,{text:"Learn more about Claude’s beta release",side:"top",children:(0,r.jsx)(C(),{href:"https://support.anthropic.com/en/articles/8525154-claude-is-providing-incorrect-or-misleading-responses-what-s-going-on",passHref:!0,className:"hover:underline hover:text-stone-800",children:Y?"Claude may display incorrect or harmful information":"Claude is in beta release and may display incorrect or harmful information"})})]})]})});let q=(0,k.forwardRef)((e,t)=>{let{disabled:n,input:a,setInput:i,placeholder:l,onKeyDown:s,onSubmit:o,onBlur:c,onFocus:d,onCompositionStart:m,onCompositionEnd:p,attachments:h,onRemoveAttachment:g,snippetCommands:x,isFirstMessage:v}=e,{editor:w,getActiveSnippetCommand:j}=useTipTap({input:a,setInput:i,snippetCommands:x,placeholder:l}),[_,C]=(0,k.useState)(!1);(0,k.useImperativeHandle)(t,()=>({setContent(e){null==w||w.commands.setContent(e)},focus(){null==w||w.commands.focus()},getPosition:()=>null==w?void 0:w.state.selection.$anchor,getEditor:()=>w,getIsAtEnd(){if(!w)return;let e=w.state.selection.$anchor.pos,t=b.Y1.atEnd(w.state.doc).$anchor.pos;return t===e}}),[w]),(0,k.useEffect)(()=>{null==w||w.setOptions({editable:!n})},[w,n]);let S=(0,u.K)();return(0,r.jsx)("div",{className:"flex items-center flex-grow overflow-x-hidden",children:(0,r.jsxs)("div",{className:"flex flex-col w-full",children:[(0,r.jsx)(A.g.Provider,{value:{setOverrideSubmit:C},children:(0,r.jsx)(y.kg,{className:"overflow-y-auto w-full max-h-96 break-words py-4",editor:w,onKeyDownCapture:e=>{if("Enter"!==e.key)return;let t=j();if(t){S.track("snippets_command_used",{command:t.label,isFirstMessage:v}),e.preventDefault(),t.action(a)&&(i(""),null==w||w.commands.setContent(""));return}!o||_||e.shiftKey||e.nativeEvent.isComposing||(0,f.t)()||(e.preventDefault(),o(e))},onKeyDown:e=>{s&&s(e)},onFocus:d,onBlur:c,onCompositionStart:m,onCompositionEnd:p})}),h.length>0&&(0,r.jsx)(ea,{children:h.map((e,t)=>(0,r.jsx)(R.Z,{attachment:e,index:t,onRemove:g},t))})]})})});q.displayName="ChatEditor";let H="https://support.anthropic.com/en/articles/8602283-does-claude-ai-have-any-message-limits";function ExceededMessageLimitWarning(e){let{messageLimit:t}=e,n=(0,o.ZJ)(),a=useLimitAction($);return(0,r.jsxs)(BlockingWarning,{actionButton:a,children:["You are out of ",n?"":"free ",(0,r.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:H,children:"messages"})," ","until"," ",(0,r.jsx)("span",{className:"inline-block",children:j.ou.fromSeconds(t.resetsAt).toFormat("h a")})]})}let V="https://support.anthropic.com/en/articles/7996848-how-large-is-claude-s-context-window";function ExceededTokenLimitWarning(){let e=(0,i.$H)("push");return(0,r.jsxs)(BlockingWarning,{actionButton:(0,r.jsx)($,{onClick:e,children:"Start a new conversation"}),children:["This conversation reached its"," ",(0,r.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:V,children:"maximum length"}),"."]})}let ReadOnlyModeWarning=()=>{let e=useLimitAction($,{allowSelfUpgrade:!1});return(0,r.jsxs)(BlockingWarning,{actionButton:e,children:["Due to capacity constraints, chatting with Claude is currently not"," ","available. Please try again in a little while."]})},BlockingWarning=e=>{let{children:t,actionButton:n}=e;return(0,r.jsx)("div",{className:"w-full",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row items-center py-2 w-full",children:[(0,r.jsxs)("div",{className:"flex flex-row md:w-full items-top gap-2 text-ant-primary py-2",children:[(0,r.jsx)(v.Z,{className:"mt-[5px] h-4 w-4 shrink-0",weight:"regular"}),(0,r.jsx)("div",{className:"text-regular",children:t})]}),!!n&&(0,r.jsx)("div",{className:"w-full md:w-fit py-2 md:py-0 whitespace-nowrap",children:n})]})})};function WillExceedTokenLimitWarning(e){let{percentTokensExceeded:t,shouldStartNewConvo:n,numAttachments:a}=e,l=(0,i.$H)("push");return(0,r.jsx)(J,{children:(0,r.jsxs)("span",{children:["Message is ",Math.round(100*t),"% over the"," ",n&&"remaining ",(0,r.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:V,children:"length limit"}),".",a>0?" Try replacing the attached file".concat(a>1?"s":""," with smaller excerpts. "):" Try shortening your message. ",n&&(0,r.jsxs)(r.Fragment,{children:[" ",(0,r.jsx)(C(),{className:"underline",href:"#",onClick:l,children:"Start a new conversation?"})]})]})})}function ApproachingMessageLimitWarning(e){let{messageLimit:t}=e,n=useLimitAction(Y);return(0,r.jsxs)(J,{children:[(0,r.jsxs)("span",{children:[pluralize(t.remaining,"message")," ",(0,r.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:H,children:"remaining"})," ","until"," ",(0,r.jsx)("span",{className:"inline-block",children:j.ou.fromSeconds(t.resetsAt).toFormat("h a")})]}),n]})}function useLimitAction(e){let{allowSelfUpgrade:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{account:n}=(0,o.t)(),a=(0,o.ZJ)(),i=(0,s.Zx)(),{value:u}=(0,S.useGate)("claude-pro-disabled");return a?null:i?t&&!u?(0,r.jsx)(e,{href:"/settings/billing?action=subscribe",children:"Subscribe to Pro"}):(0,r.jsx)(e,{href:(0,l.CE)((null==n?void 0:n.email_address)||"",h.m),target:"_blank",children:"Get notified about paid plans"}):(0,r.jsx)(e,{href:"mailto:sales@anthropic.com",children:"Contact us to upgrade"})}let $=(0,m.Z)(d.Z)(_templateObject()),Y=(0,m.Z)(C())(_templateObject1()),J=m.Z.div(_templateObject2()),X=m.Z.div(_templateObject3()).css(_templateObject4()),ee=m.Z.fieldset(_templateObject5()),et=m.Z.div(_templateObject6()).css(_templateObject7()),en=m.Z.div(_templateObject8()).css(_templateObject9()),ea=m.Z.div(_templateObject10()),er=m.Z.div(_templateObject11()),ei=m.Z.div(_templateObject12()).css(_templateObject13());function useChatInputStorage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",[n,a,r]=(0,c.Z)("".concat(e,":attachment"),[]),[i,l,s]=(0,c.Z)("".concat(e,":textInput"),t),o=(0,k.useCallback)(()=>{s(),r()},[r,s]);return{attachments:n,setAttachments:a,input:i,setInput:l,clear:o}}function usePasteInterceptor(e,t,n){let a=function(e,t,n){var a;let{addError:r}=(0,W.e)(),i=(0,k.useCallback)(e=>{n(!1),e&&r(e)},[r,n]),{activeOrganization:s}=(0,o.t)(),u=null!==(a=null==s?void 0:s.uuid)&&void 0!==a?a:"",c=(0,k.useCallback)(async e=>{let t;let n=new URL("/api/fetch_url",window.location.origin);n.searchParams.set("orgUuid",u),n.searchParams.set("url",e);try{t=await fetch(n)}catch(e){return(0,K.Tb)(e),i("One or more fetches have failed. Try again.")}if(429===t.status)return i("Too many fetch attempts. Please wait and try again later.");if(!t.ok){let e=await t.json();return"fetch_unsupported_filetype"===e.error.code?i():i("Fetching failed for one of the URLs. Please try again.")}let a=await t.json();return a&&0!==Object.keys(a).length&&a.extracted_content?a:i("Text extraction failed for one of the URLs.")},[u,i]),{value:d}=(0,S.useGate)("hatch_use_web_fetcher");return(0,k.useCallback)(async a=>{if(!d)return;let r=[],s=(0,l.Yl)(a);if(0!==s.length){if(e.length+s.length>Q.nh)return i("You can add at most ".concat(Q.nh," attachments to a message. Please select fewer attachments."));for(let t=0;t<s.length;t++){let a=s[t];if(e.some(e=>a.endsWith(e.file_name)))continue;n(!0);let i=await c(a);if(!i)return;r.push(i)}r.forEach(e=>(0,Q.Ch)(e)),r.length>0&&t(e=>[...e,...r]),n(!1)}},[d,c,i,e,n,t])}(e,t,n);return(0,k.useCallback)(n=>{var r;if(e.length>=Q.nh)return;let i=null===(r=n.clipboardData)||void 0===r?void 0:r.getData("text/plain");a(i).catch(console.error),i&&!(i.length<4e3)&&(n.preventDefault(),t(e=>{let t="paste.txt",n=1;for(;e.some(e=>e.file_name===t);)n+=1,t="paste-".concat(n,".txt");let a={file_name:t,file_size:i.length,file_type:"txt",extracted_content:i};return[...e,a]}))},[e,t,a])}let useMessageLimit=()=>{let{activeOrganization:e,messageLimit:t}=(0,o.t)();return(null==e?void 0:e.capabilities.includes("api"))?{}:(null==t?void 0:t.type)==="exceeded_limit"||(null==t?void 0:t.type)==="approaching_limit"&&0===t.remaining?{exceededMessageLimitWarning:(0,r.jsx)(ExceededMessageLimitWarning,{messageLimit:t})}:(null==t?void 0:t.type)==="approaching_limit"?{approachingMessageLimitWarning:(0,r.jsx)(ApproachingMessageLimitWarning,{messageLimit:t})}:{}},isCompactMobile=()=>window.innerWidth<385,el={hardLimit:9e4},useTokenLimit=e=>{let{input:t,attachments:n,conversationTokensSoFar:a}=e,{config:i}=(0,S.useConfig)("hatch_token_limits"),l=(0,o.ZJ)(),s=(0,P.wN)(),u=i.get("".concat(s,":").concat(l?"pro":"free"),el).hardLimit,c=(0,k.useMemo)(()=>n.map(e=>e.extracted_content).join(" "),[n]),d=(0,z.c)(t)+(0,z.c)(c),m=a>u,p=m?(0,r.jsx)(ExceededTokenLimitWarning,{}):null,f=!m&&d+a>u?(0,r.jsx)(WillExceedTokenLimitWarning,{percentTokensExceeded:d/(u-a)-1,shouldStartNewConvo:d<u,numAttachments:n.length}):null,h=d>1e5?(0,r.jsx)(J,{className:"!justify-center",children:(0,r.jsx)("span",{className:"font-semibold",children:"Long prompts or documents may take multiple minutes to respond"})}):null;return{exceededTokenLimitWarning:p,willExceedTokenLimitWarning:f,slowResponseWarning:h,messageTokenCount:d}}},92577:function(e,t,n){n.d(t,{g:function(){return r}});var a=n(7653);let r=(0,a.createContext)({setOverrideSubmit:()=>!1})},5718:function(e,t,n){n.d(t,{Z:function(){return FileAttachment}});var a=n(58882),r=n(27573),i=n(98935),l=n(28192),s=n(90794),o=n(7653),u=n(1811);function FilePreviewButtonBar(e){let{children:t}=e;return(0,r.jsx)("div",{className:"absolute top-3 right-4 flex gap-2",children:t})}function FilePreviewButton(e){let{size:t="small",...n}=e;return(0,r.jsx)(u.Z,{size:t,...n})}function DialogContent(e){let{title:t,subtitle:n,children:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"p-4 pb-2 flex flex-col sm:flex-col md:flex-row items-start md:items-center gap-0 md:gap-4",children:[t&&(0,r.jsx)(i.V.Title,{as:"h3",className:"text-sm sm:text-base md:text-lg lg:text-xl font-medium leading-6 text-stone-800 mb-1 truncate lg:not-truncate max-w-[20ch] lg:max-w-full",children:t}),n&&(0,r.jsx)("p",{className:"text-sm sm:text-xs md:text-sm text-stone-800",children:n})]}),(0,r.jsx)("div",{className:"max-h-[80vh] flex flex-col ",children:a})]})}function FilePreviewModal(e){let{title:t,subtitle:n,isOpen:a,className:u,children:c,onClose:d,modalSize:m="md",backgroundColor:p}=e,f=(0,o.useRef)(null);return(0,r.jsx)(l.u,{appear:!0,show:a,as:o.Fragment,children:(0,r.jsxs)(i.V,{as:"div",initialFocus:f,onClose:d,className:(0,s.Z)("rounded-lg px-6 py-6 flex flex-col w-4/5 sm:max-w-lg overflow-visible",u),children:[(0,r.jsx)(l.u.Child,{as:o.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"z-40 fixed inset-0 bg-black bg-opacity-25"})}),(0,r.jsx)("div",{className:"z-50 fixed inset-0 overflow-y-auto",children:(0,r.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,r.jsx)(l.u.Child,{as:o.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,r.jsx)(i.V.Panel,{className:(0,s.Z)("w-full transform rounded-2xl text-left align-middle shadow-xl transition-all","md"===m&&"max-w-md","lg"===m&&"max-w-6xl","xl"===m&&"max-w-7xl",null!=p?p:"bg-white"),children:(0,r.jsx)(DialogContent,{title:t,subtitle:n,children:(0,r.jsx)("div",{className:"prose h-full overflow-auto w-full max-w-none whitespace-pre-wrap px-4 py-4 bg-uivory-100 rounded-bl-xl rounded-br-xl grid place-items-center",children:c})})})})})})]})})}var c=n(55616),d=n(61573);function _templateObject(){let e=(0,a._)(["\n  absolute\n  inset-0\n  cursor-pointer\n  hover:bg-black/5\n  w-40\n"]);return _templateObject=function(){return e},e}function FileAttachment(e){var t,n;let a,i,{attachment:l,index:s,onRemove:u}=e;a=l.file_size<1048576?(l.file_size/1024).toFixed(2)+" KB":(l.file_size/1048576).toFixed(2)+" MB";let c=null===(t=l.file_name)||void 0===t?void 0:t.split(".");i="plain"===(i="html"===l.file_type?"html":c.length>1&&null!==(n=c.pop())&&void 0!==n?n:l.file_type.split("/")[1])?"txt":i;let[p,f]=(0,o.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"w-40 relative cursor-pointer rounded-md flex shadow-element text-xs bg-white","aria-label":l.file_name,title:l.file_name,children:[(0,r.jsx)(m,{onClick:()=>f(!0),"aria-label":"Preview contents"}),(0,r.jsx)("div",{className:"flex-shrink-0 w-12 h-12 bg-ant-primary rounded-tl-md rounded-bl-md grid place-items-center text-white font-medium uppercase truncate","aria-hidden":!0,children:i}),(0,r.jsxs)("div",{className:"py-2 px-3 min-w-0",children:[(0,r.jsx)("p",{className:"truncate",title:l.file_name,children:l.file_name}),(0,r.jsx)("div",{className:"text-gray-500",children:a}),u&&(0,r.jsx)("div",{className:"absolute top-0 right-0 bg-white shadow-element p-1 rounded-full cursor-pointer hover:bg-stone-100 translate-x-2 -translate-y-2 z-10",onClick:e=>{e.stopPropagation(),u(s)},children:(0,r.jsx)(d.Z,{size:11,weight:"bold"})})]})]}),(0,r.jsxs)(FilePreviewModal,{isOpen:p,onClose:()=>f(!1),title:l.file_name,subtitle:"".concat(l.extracted_content.split("\n").length," extracted lines"),modalSize:"xl",children:[l.extracted_content,(0,r.jsx)(FilePreviewButtonBar,{children:(0,r.jsx)(FilePreviewButton,{variant:"borderless",onClick:()=>f(!1),"data-testid":"close-file-attachment",children:(0,r.jsx)(d.Z,{size:19})})})]})]})}let m=c.Z.button(_templateObject())},53544:function(e,t,n){n.d(t,{nh:function(){return v},Ch:function(){return escapeAttachmentStrings},kS:function(){return useFileUploadForAttachments}});var a=n(58882),r=n(27573),i=n(22809),l=n(45440),s=n(55616),o=n(55880),u=n(64231),c=n(65750),d=n(39547),m=n(7653);let p=[".DS_Store"],f=["jpg","jpeg","png","gif","bmp","ico","tiff","tif","psd","raw","cr2","nef","orf","sr2","mobi","jp2","jpx","jpm","mj2","svg","svgz","ai","eps","ps","indd","heic","mp4","mov","avi","mkv","wmv","flv","webm","mpeg","mpg","m4v","3gp","ogv","ogg","rm","rmvb","asf","amv","mpe","m1v","m2v","svi","3g2","roq","nsv","f4v","f4p","f4a","f4b","qt","hdmov","divx","div","m2ts","mts","vob","mp3","wav","wma","aac","flac","alac","aiff","ogg","opus","m4a","amr","awb","wmv","ra","rm","mid","midi","mka","ttf","otf","woff","woff2","eot","sfnt","ttc","suit","zip"],h=["Makefile","README","Dockerfile"],g=["txt","py","ipynb","js","jsx","html","css","java","cs","php","c","cpp","cxx","h","hpp","rs","R","Rmd","swift","go","rb","kt","kts","ts","tsx","m","scala","rs","dart","lua","pl","pm","t","sh","bash","zsh","csv","log","ini","config","json","yaml","yml","toml","lua","sql","bat","md","coffee","tex","latex"],x=[".pdf",".doc",".docx",".rtf",".epub",".odt",".odp",".pptx",...g.map(e=>".".concat(e))],getFileExtension=e=>e.split(".").pop().toLowerCase(),isUnsupportedFileUpload=e=>{let t=getFileExtension(e.name);return f.includes(t)},isSupportedPlainTextFile=e=>{let t=getFileExtension(e.name);return h.includes(e.name)||g.includes(t)},shouldIgnoreFileUpload=e=>!!p.includes(e.name);function _templateObject(){let e=(0,a._)(["\n  relative\n  grid\n  place-content-center\n  aspect-square\n  rounded-xl\n  cursor-pointer\n  bg-uivory-100\n  [fieldset:not(:disabled)_&]:hover:bg-uivory-300\n  [fieldset:disabled_&]:opacity-50\n  [fieldset:disabled_&]:pointer-events-none\n  focus-within:ring\n"]);return _templateObject=function(){return e},e}let v=5,getFullFileName=e=>{let t=e.webkitRelativePath;return t&&t.length?t:e.name},escapePlainTextString=e=>e.replace(/\0/g,""),escapeAttachmentStrings=e=>{e.extracted_content=escapePlainTextString(e.extracted_content),e.file_name=escapePlainTextString(e.file_name),e.file_type=escapePlainTextString(e.file_type)},makePlainTextFileAttachment=async e=>{let t=getFullFileName(e),n={file_name:t,file_type:e.type,file_size:e.size,extracted_content:await e.text()};return n};function useFileUploadForAttachments(e){let{setAttachments:t,attachments:n,detectSameAttachment:a}=e,{addError:s}=(0,l.e)(),p=(0,m.useCallback)(e=>{if(a){let t=e.find(e=>a(e.extracted_content));t&&s("The same attachment was already added earlier. Claude sees the full conversation when replying, so there's no need to re-upload.")}t(t=>[...t,...e])},[t,a,s]);return function(e){let{onUploadComplete:t,attachments:n}=e,[a,s,p]=function(e){var t;let{onUploadComplete:n,attachments:a}=e,[r,s]=(0,m.useState)(!1),{addError:o}=(0,l.e)(),u=(0,m.useCallback)(e=>{s(!1),o(e)},[o,s]),{activeOrganization:c}=(0,i.t)(),p=null!==(t=null==c?void 0:c.uuid)&&void 0!==t?t:"",f=(0,m.useCallback)(async e=>{let t;let n=new FormData;n.append("file",e),n.append("orgUuid",p);try{t=await fetch("/api/convert_document",{method:"POST",body:n})}catch(e){return(0,d.Tb)(e),u("One or more file uploads have failed. Please try again.")}if(429===t.status)return u("Too many file upload attempts. Please wait and try again later.");if(413===t.status)return u("Uploaded file is too large. Try uploading a smaller part of the document, or copy/pasting an excerpt from the file.");if(!t.ok)return u("Text extraction failed for one of the uploaded files. Please try again.");let a=await t.json();return a&&0!==Object.keys(a).length&&a.extracted_content?(a.file_name=getFullFileName(e),a):u("Text extraction failed for one of the uploaded files. Please try again.")},[p,u]);return[r,s,(0,m.useCallback)(async e=>{let t=[];e=e.filter(e=>!shouldIgnoreFileUpload(e));let r=e.filter(e=>isUnsupportedFileUpload(e)).map(e=>getFileExtension(e.name));if(r.length>0)return u("You may not upload files of the following format: (".concat([...new Set(r)].join(", "),"). Please remove them and try again."));if(e.length+a.length>v)return u("You can add at most ".concat(v," attachments to a message. Please select fewer attachments."));let i=e.reduce((e,t)=>Math.max(e,t.size),0);if(i>1e7)return u("You may not upload files larger than 10MB.");s(!0);for(let n=0;n<e.length;n++){let a=e[n];if(isSupportedPlainTextFile(a))t.push(await makePlainTextFileAttachment(a));else{let e=await f(a);if(!e)return;t.push(e)}}t.forEach(e=>escapeAttachmentStrings(e)),n(t),s(!1)},[u,n,a,f])]}({onUploadComplete:t,attachments:n}),f=function(e){let{handleUpload:t}=e,n=(0,m.useRef)({ready:0,total:0}),a=(0,m.useCallback)(()=>{n.current={ready:0,total:0}},[]),r=(0,m.useCallback)(e=>{n.current.ready+=1,n.current.total===n.current.ready&&t(e)},[t]),i=(0,m.useCallback)((e,t)=>{let a=e.length;for(let l=0;l<a;l++){let a=e[l];if(a.isFile)n.current.total+=1,a.file(e=>{t.push(e),r(t)});else if(a.isDirectory){let e=a.createReader();e.readEntries(e=>{i(e,t)})}}},[r]),l=(0,m.useCallback)(e=>{var t;e.preventDefault(),a();let n=null===(t=e.dataTransfer)||void 0===t?void 0:t.items;if(!n)return;let r=[];for(let e=0;e<(null==n?void 0:n.length);e++){let t=n[e].webkitGetAsEntry();t&&r.push(t)}i(r,[])},[i,a]);return l}({handleUpload:p}),h=(0,m.useCallback)(e=>{let t=e.target.files;t&&p(Array.from(t))},[p]);return[a,s,f,(0,r.jsx)(o.Z,{text:"Add Files (".concat(v," max, 10MB each)\nAccepts pdf, txt, csv, etc."),children:(0,r.jsxs)(b,{children:[(0,r.jsx)("input",{"data-testid":"file-upload",type:"file",className:"opacity-0 absolute inset-0 rounded-xl -z-10 overflow-hidden",accept:x.join(","),onChange:h,multiple:!0}),a?(0,r.jsx)(u.Z,{className:"animate-spin",size:18}):(0,r.jsx)(c.Z,{size:18,weight:"light"})]})},"upload-tooltip")]}({onUploadComplete:p,attachments:n})}let b=s.Z.label(_templateObject())},32683:function(e,t,n){n.d(t,{p:function(){return useGetSystemSnippetCommands}});var a=n(22809),r=n(45440),i=n(7653),l=n(83127);let useGetSystemSnippetCommands=(e,t)=>{let{value:n}=(0,l.useGate)("claude-app-retrieval"),a=useGetSlackMessages(),r=(0,i.useMemo)(()=>[{label:"slack",shortParamName:"query",paramPlaceholder:"query to filter slack threads, try '<@username>' or '#channel-name'",action:n=>((async()=>{t(!0);let r=await a(n.trim());t(!1),r&&e(e=>[...e,r])})(),!0)}],[a,e,t]);return n?r:[]},useGetSlackMessages=()=>{let{activeOrganization:e}=(0,a.t)(),{addError:t}=(0,r.e)();return(0,i.useCallback)(async n=>{let a;if(n.length<3)return t("Slack query must be at least 3 characters.");if(!(null==e?void 0:e.uuid))return;let r=new URL("/api/retrieval",document.location.origin);r.searchParams.set("q",n),r.searchParams.set("orgUuid",null==e?void 0:e.uuid);try{a=await fetch(r)}catch(e){return t("Slack retrieval failed. Try again.")}if(!a.ok)return t("Slack retrieval failed. Try again.");let i=await fetch(r),l=await i.json(),s={file_name:"slack.txt",file_size:l.result.length,file_type:"txt",extracted_content:l.result};return s},[null==e?void 0:e.uuid,t])}},3660:function(e,t,n){n.d(t,{Fy:function(){return useSnippets},Lt:function(){return h},Ve:function(){return useUserSnippetConfig},k7:function(){return useSnippetTurndownService},ms:function(){return f}});var a=n(58882),r=n(27573),i=n(19981),l=n(55616),s=n(61501),o=n(53910),u=n(7653),c=n(18637),d=n(83461),m=n(92577);function _templateObject(){let e=(0,a._)(["\n  relative\n  p-1\n  bg-white\n  rounded-md\n  overflow-hidden\n  shadow-md\n"]);return _templateObject=function(){return e},e}function _templateObject1(){let e=(0,a._)(["\n ","\n"]);return _templateObject1=function(){return e},e}function _templateObject2(){let e=(0,a._)(["\n  ","\n  inline-block\n  ml-1\n  py-0\n  text-sm\n  italic\n"]);return _templateObject2=function(){return e},e}function _templateObject3(){let e=(0,a._)(["\n  ","\n  ","\n"]);return _templateObject3=function(){return e},e}let useUserSnippetConfig=()=>{let e=(0,s.useQuery)(["snippetConfig"],()=>{let e=localStorage.getItem("snippetConfig");return e?JSON.parse(e):[]},{initialData:[]}),t=e.data||[],n=(0,u.useCallback)(t=>{let n=t;"function"==typeof t&&(n=t(e.data||[])),localStorage.setItem("snippetConfig",JSON.stringify(n)),e.refetch()},[e]);return{userSnippets:t,setUserSnippets:n}},useGetFullSnippetConfig=e=>{let{userSnippets:t}=useUserSnippetConfig(),n=(0,u.useMemo)(()=>{let n=t.filter(t=>!e.find(e=>e.label===t.label));return[...n,...e.map(e=>({label:e.label,substitution:""}))]},[t,e]);return n},p=(0,u.forwardRef)((e,t)=>{let[n,a]=(0,u.useState)(0);(0,u.useEffect)(()=>a(0),[e.items]);let l=(0,i.K)(),{setOverrideSubmit:s}=(0,u.useContext)(m.g);(0,u.useEffect)(()=>(s(!0),()=>s(!1)),[s]);let selectItem=t=>{let n=e.items[t];n&&(l.track("snippets_suggestion_selected"),e.command({id:n.label,label:n.label}))};return(0,u.useImperativeHandle)(t,()=>({onKeyDown:t=>{let{event:r}=t;return"ArrowUp"===r.key?(a((n+e.items.length-1)%e.items.length),r.stopPropagation(),!0):"ArrowDown"===r.key?(a((n+1)%e.items.length),r.stopPropagation(),!0):"Enter"===r.key&&(selectItem(n),!0)}})),(0,r.jsx)(g,{children:e.items.length?e.items.map((e,t)=>(0,r.jsxs)(y,{$selected:t===n,onClick:()=>selectItem(t),children:[e.label,e.shortParamName&&(0,r.jsx)(b,{children:e.shortParamName})]},t)):(0,r.jsx)(v,{children:"No result"})})});p.displayName="SnippetList";let useSnippets=e=>{let t=useGetFullSnippetConfig(e),n=(0,u.useRef)(t);n.current=t;let a=(0,u.useMemo)(()=>({items:t=>{let{query:a}=t,getShortParamName=t=>{var n;let a=e.find(e=>e.label===t);return null!==(n=null==a?void 0:a.shortParamName)&&void 0!==n?n:""},r=n.current;return r.filter(e=>e.label.toLowerCase().startsWith(a.toLowerCase())).slice(0,5).map(e=>({label:e.label,shortParamName:getShortParamName(e.label)}))},render:()=>{let e,t;return{onStart:n=>{n.clientRect&&(e=new o.M_(p,{props:n,editor:n.editor}),t=(0,c.ZP)("body",{getReferenceClientRect:n.clientRect,appendTo:()=>document.body,content:e.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}))},onUpdate(n){e.updateProps(n),n.clientRect&&t[0].setProps({getReferenceClientRect:n.clientRect})},onKeyDown(n){var a;return"Escape"===n.event.key?(t[0].hide(),!0):(null===(a=e.ref)||void 0===a?void 0:a.onKeyDown(n))||!1},onExit(){t[0].destroy(),e.destroy()}}}}),[e]);return a},useSnippetTurndownService=e=>{let t=useGetFullSnippetConfig(e);return(0,u.useMemo)(()=>new d.Z().addRule("snippets",{filter:e=>"SPAN"===e.nodeName&&"mention"===e.getAttribute("data-type"),replacement(e,n){var a,r;let i=null!==(a=n.getAttribute("data-id"))&&void 0!==a?a:"",l=t.find(e=>e.label===i);return null!==(r=null==l?void 0:l.substitution)&&void 0!==r?r:n.innerText}}),[t])},f="p-1 shadow-sm bg-indigo-100 rounded-md",h="text-stone-500 bg-stone-100 p-1 rounded-md",g=l.Z.div(_templateObject()),x="\n  block\n  w-full\n  text-left\n  p-1\n",v=l.Z.div(_templateObject1(),x),b=l.Z.div(_templateObject2(),h),y=l.Z.button(_templateObject3(),x,e=>e.$selected&&"bg-indigo-100")},65679:function(e,t,n){n.d(t,{SM:function(){return useChatNavigate},sn:function(){return searchParamString},tA:function(){return useNavigateToDefaultChat}});var a=n(32859),r=n(7653),i=n(80028);let searchParamString=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=new URLSearchParams(e);t.forEach(e=>n.delete(e));let a=n.toString();return a?"?".concat(a):a},useChatNavigate=()=>{let e=(0,a.useRouter)(),t=(0,a.useSearchParams)(),n=(0,r.useMemo)(()=>{let e=new URLSearchParams;(null==t?void 0:t.has("model"))&&e.append("model",t.get("model")),(null==t?void 0:t.has("speak"))&&e.append("speak",t.get("speak")),(null==t?void 0:t.has("t"))&&e.append("t",t.get("t")),(null==t?void 0:t.has("q"))&&e.append("q",t.get("q"));let n=e.toString();return n?"?".concat(n):""},[t]),i=(0,r.useCallback)(t=>e.push("".concat(t).concat(n)),[e,n]),l=(0,r.useCallback)(t=>e.replace("".concat(t).concat(n)),[e,n]);return{push:i,replace:l}},useNavigateToDefaultChat=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"push",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],{data:n,isSuccess:a}=(0,i.QR)(),l=(0,i.$H)(e),s=useChatNavigate();return(0,r.useCallback)(()=>{if(!n||!a)return!1;let r=n.find(e=>!t.includes(e.uuid)),i=s[e];return r?i("/chat/".concat(r.uuid)):l(),!0},[n,l,a,s,t,e])}},90643:function(e,t,n){n.d(t,{c:function(){return useTokenCounter}});var a=n(7653);function useTokenCounter(e){let[t,r]=(0,a.useState)(0),i=(0,a.useRef)(null);return(0,a.useEffect)(()=>{if(!i.current){if("undefined"==typeof Worker)return;let e=new Worker(n.tu(new URL(n.p+n.u(7376),n.b)));e.onmessage=e=>r(e.data),i.current=e}return()=>{var e;null===(e=i.current)||void 0===e||e.terminate(),i.current=null}},[]),(0,a.useEffect)(()=>{i.current&&i.current.postMessage(e)},[e]),t}},30762:function(e,t,n){n.d(t,{Z:function(){return useLocalStorageState}});var a=n(4913),r=n.n(a),i=n(7653);let getStorageKey=e=>"LSS-".concat(e);function useLocalStorageState(e,t){let[n,a]=(0,i.useState)(()=>{try{let n=window.localStorage.getItem(getStorageKey(e));return n?JSON.parse(n):t}catch(e){return console.log(e),t}}),l=(0,i.useRef)(r()(t=>{try{window.localStorage.setItem(getStorageKey(e),JSON.stringify(t))}catch(e){console.log(e)}},250)),s=(0,i.useCallback)(()=>{a(t),setTimeout(()=>{l.current.cancel(),window.localStorage.removeItem(getStorageKey(e))},0)},[a,t,e]);return(0,i.useEffect)(()=>{l.current(n)},[n]),[n,a,s]}},38338:function(e,t,n){var a=n(27573),r=n(22809),i=n(33607),l=n(90794);t.Z=e=>{var t,n,s;let{name:o,account:u,size:c="md"}=e,d=null!==(s=null!==(n=null!==(t=null!=o?o:null==u?void 0:u.full_name)&&void 0!==t?t:null==u?void 0:u.display_name)&&void 0!==n?n:null==u?void 0:u.email_address)&&void 0!==s?s:"",m=d.split(" ").map(e=>0===e.length?"":e[0]).join("").substring(0,2).toLocaleUpperCase(),p=(0,r.ZJ)();return(0,a.jsx)("div",{className:(0,l.Z)("font-bold rounded-full flex items-center justify-center text-bg-200",{"h-8 w-8 text-[14px]":"md"===c,"h-4 w-4 text-[8px]":"sm"===c,"h-10 w-10 text-lg":"lg"===c,"h-16 w-16 text-2xl":"xl"===c,"bg-text-200":!p,"bg-ant-primary":p}),children:m||(0,a.jsx)(i.Z,{className:"rounded-full text-white",weight:(0,l.Z)({regular:"sm"===c,light:"md"===c,thin:"lg"===c}),size:(0,l.Z)({12:"sm"===c,20:"md"===c,40:"lg"===c})})})}},1811:function(e,t,n){n.d(t,{Z:function(){return Button}});var a=n(27573),r=n(90794),i=n(2056),l=n.n(i);function Button(e){let{variant:t="primary",size:n="medium",icon:i=!1,loading:s=!1,stretch:o=!1,disabled:u=!1,href:c,onClick:d,className:m="",children:p,type:f,...h}=e,g=(0,r.Z)("inline-flex items-center justify-center gap-1 py-2 font-semibold md:font-medium rounded-lg transition-colors disabled:opacity-50 disabled:pointer-events-none",{"w-full":o},i?"px-2":"px-3",{small:"text-sm",medium:"",large:"text-lg"}[n],{primary:"bg-ant-primary hover:bg-ant-primary-h disabled:bg-ant-secondary-h text-white",secondary:"bg-uivory-300 ring-1 ring-inset ring-stone-200 hover:bg-white",borderless:"bg-transparent hover:bg-uivory-300",danger:"bg-rose-600 text-white hover:bg-rose-700 ring-0"}[t],m),x=p;if(s&&(x=(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"invisible",children:p}),(0,a.jsx)("div",{className:"absolute top-0 left-1/2 -translate-x-1/2",children:(0,a.jsx)("div",{className:"inline-block w-4 h-4 animate-spin rounded-full border-2 border-solid border-stone-300 border-r-transparent align-[-0.125em] text-secondary motion-reduce:animate-[spin_1.5s_linear_infinite]",role:"status",children:(0,a.jsx)("span",{className:"sr-only",children:"Loading..."})})})]})),null!=c){if(f)throw Error("Cannot use type and href");return(0,a.jsx)(l(),{href:c,className:g,onClick:d,...h,children:x})}return(0,a.jsx)("button",{onClick:d,className:g,disabled:u||s,type:f,...h,children:x})}},30773:function(e,t,n){n.d(t,{Z:function(){return Loading}});var a=n(27573),r=n(90794);function Loading(e){let{size:t="md",color:n="secondary",fullscreen:i=!1}=e;return(0,a.jsx)("div",{className:(0,r.Z)(i?"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2":"m-auto"),children:(0,a.jsx)("div",{className:(0,r.Z)("sm"===t&&"h-4 w-4 border-2","md"===t&&"h-20 w-20 border-8","secondary"===n&&"border-uivory-300","primary"===n&&"border-ant-primary","inline-block animate-spin rounded-full border-solid border-r-transparent align-[-0.125em] text-secondary motion-reduce:animate-[spin_1.5s_linear_infinite]"),role:"status",children:(0,a.jsx)("span",{className:"sr-only",children:"Loading..."})})})}},55880:function(e,t,n){n.d(t,{Z:function(){return Tooltip}});var a=n(58882),r=n(27573),i=n(55616),l=n(29079);function _templateObject(){let e=(0,a._)(["\n  px-2\n  py-1\n  text-xs\n  font-medium\n  font-sans\n  leading-tight\n  rounded-md\n  shadow-md\n  text-white\n  bg-black/80\n  backdrop-blur\n  max-w-[13rem]\n  [*:disabled_&]:hidden\n"]);return _templateObject=function(){return e},e}function Tooltip(e){let{children:t,text:n,side:a="top",className:i,...o}=e;return(0,r.jsx)(l.zt,{delayDuration:0,children:(0,r.jsxs)(l.fC,{...o,children:[(0,r.jsx)(l.xz,{asChild:!0,children:t}),(0,r.jsx)(s,{className:i,sideOffset:5,side:a,children:Array.isArray(n)?n.map((e,t)=>(0,r.jsxs)("span",{children:[e,(0,r.jsx)("br",{})]},t)):n})]})})}let s=(0,i.Z)(l.VY)(_templateObject())},55616:function(e,t,n){var a=n(58882),r=n(58943);function _templateObject(){let e=(0,a._)([""]);return _templateObject=function(){return e},e}function makeTailwind(e){let styled=function(t){let n;for(var a=arguments.length,r=Array(a>1?a-1:0),i=1;i<a;i++)r[i-1]=arguments[i];if(r.some(e=>"function"==typeof e))n=e.attrs(e=>{let n=t.map((t,n)=>{let a=r[n],i="function"==typeof a?a(e):a;return"".concat(t).concat(null!=i?i:"")}).join("");return{className:n}});else{let a=t.map((e,t)=>{var n;return"".concat(e).concat(null!==(n=r[t])&&void 0!==n?n:"")}).join("");n=e.attrs({className:a})}let l=n;return Object.assign(l(_templateObject()),{css:l})};return styled.attrs=t=>{let n=e.attrs(t);return makeTailwind(n)},styled}function tailwind(e){return makeTailwind((0,r.ZP)(e))}tailwind.a=makeTailwind(r.ZP.a),tailwind.aside=makeTailwind(r.ZP.aside),tailwind.button=makeTailwind(r.ZP.button),tailwind.div=makeTailwind(r.ZP.div),tailwind.nav=makeTailwind(r.ZP.nav),tailwind.fieldset=makeTailwind(r.ZP.fieldset),tailwind.h1=makeTailwind(r.ZP.h1),tailwind.h2=makeTailwind(r.ZP.h2),tailwind.h3=makeTailwind(r.ZP.h3),tailwind.h4=makeTailwind(r.ZP.h4),tailwind.input=makeTailwind(r.ZP.input),tailwind.label=makeTailwind(r.ZP.label),tailwind.p=makeTailwind(r.ZP.p),tailwind.section=makeTailwind(r.ZP.section),t.Z=tailwind},33039:function(e,t,n){function isMobile(){return window.innerWidth<640}n.d(t,{V:function(){return isMac},t:function(){return isMobile}});let a=/(macintosh|macintel|macppc|mac68k|macos)/i;function isMac(){let e=window.navigator.userAgent.toLowerCase();return a.test(e)}},82083:function(e,t,n){n.d(t,{H:function(){return randomUUID}});let randomUUID=()=>void 0===crypto.randomUUID?"".concat(1e7,"-",1e3,"-",4e3,"-",8e3,"-",1e11).replace(/[018]/g,e=>{let t=parseInt(e);return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}):crypto.randomUUID()}}]);
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5479],{58355:function(e,t,n){n.d(t,{rz:function(){return advancedTextToMessages},Yl:function(){return extractUrls},jA:function(){return fixUnicodeBulletsAsListItemPrefixes},jM:function(){return messagesToAdvancedText},Yr:function(){return messagesToPrompt},CE:function(){return stableRandomSelect}});var r=n(69507),a=n(17492);function fixUnicodeBulletsAsListItemPrefixes(e){return e.replace(/(^|\n)(\s?)•(\s?)/g,"$1$2- ")}function messagesToPrompt(e){let{messages:t,prependSystemPrompt:n,currentDateTime:a,useLegacyDocumentFormat:o}=e,s="The following is a conversation between a human and an AI assistant. The assistant is named Claude, created by the company Anthropic. The assistant has access to the current date ".concat(a.toFormat("EEEE, MMMM d, yyyy"),".");return(0,r.V9)({messages:t,prependSystemPrompt:n,systemPrompt:s,useLegacyDocumentFormat:o})}function messagesToAdvancedText(e){return e?e.map(e=>"\n\n".concat("human"===e.sender?"Human":"Assistant",": ").concat(e.text)).join("").trimEnd():""}let o='Please start your prompt with two newlines, and then "Human: <message>"';function advancedTextToMessages(e){var t,n;if(""===e)return[];let r=/^([Hh]uman|[Aa]ssistant):/m,a=[],s=Date.now()-1e3,i=null!==(n=null===(t=e.match(/[^\n]/))||void 0===t?void 0:t.index)&&void 0!==n?n:0;for(;i<e.length;){let t=e.substring(i),n=t.substring(2).match(r),u=(null==n?void 0:n.index)?n.index+2:t.length,l=t.substring(0,u),c=l.indexOf(":");if(-1===c){if(0===a.length)return Error(o);return Error("Error parsing message")}let d=l.substring(0,c).toLowerCase(),m=l.substring(c+1);if(m.startsWith(" ")&&(m=m.substring(1)),m.endsWith("\n")&&(m=m.substring(0,m.length-1)),m.endsWith("\n")&&(m=m.substring(0,m.length-1)),0===a.length&&"human"!==d)return Error(o);if("human"!==d&&"assistant"!==d)return Error("Error parsing message");if(a.length>0){let t=a[a.length-1].sender;if(d===t)return function(e,t,n){let r=function(e,t){let n=e.split("\n"),r=0;for(let e=0;e<n.length;e++){let a=n[e].length;if(r+a>t)return[e,a>30?"".concat(n[e].substring(0,27),"…"):n[e]];r+=a+1}return null}(t,n);if(!r)return Error("Message format is invalid");{let[t,n]=r;return Error("Line ".concat(t,' ("').concat(n,'") contains an error. ').concat(e))}}("human"===t?"A message from Human should be followed by one from Assistant.":"A message from Assistant should be followed by one from Human.",e,i)}a.push({created_at:new Date(s+a.length).toISOString(),text:m,sender:d,is_edited:!0,attachments:[],index:a.length}),i+=u}return a.length>0&&"assistant"!==a[a.length-1].sender?Error('Please end your prompt with "Assistant:", or alternatively, "Assistant: <beginning of Assistant response>".'):a}let s=/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=+$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=+$,\w]+@)[A-Za-z0-9.-]+)((?:\/[+~%/.\w-_]*)?\??(?:[-+=&;%@.\w_]*)#?(?:[\w]*))?)/gi;function extractUrls(e){if(!e)return[];let t=e.matchAll(s),n=new Set;for(let e of t)Array.isArray(e)&&e[0]&&n.add(e[0]);return Array.from(n)}function stableRandomSelect(e,t){let n=(0,a.createHmac)("sha256",e).digest("hex");return t[Number("0x".concat(n))%t.length]}},90274:function(e,t,n){n.d(t,{Cb:function(){return o},Lz:function(){return streamCompletion}});var r,a,o,s,i=n(38348),u=n(3099),l=n(39547);let Smoother=class Smoother{_set_raw_completion(e,t){0===this.start&&(this.start=Date.now()),this.text+=e,this.model_done=t,this.arrivals.push([(Date.now()-this.start)/1e3,this.text.length])}_get_smoothed_completion(){if(0===this.start)return"";let e=(Date.now()-this.start)/1e3,t=this.arrivals[this.arrivals.length-1][1]+(this.model_done?100:0),n=.9*e-.3,r=this.arrivals.filter(e=>e[0]<n).map(e=>e[1]),a=r[r.length-1],o=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.01;if(t===n)return t;let a=e(t),o=e(n);if(t>=n)throw Error("Lower x is greater than upper x");if(a>r)throw Error("Lower f is greater than zero");if(o<-r)throw Error("Upper f is less than zero");for(;a<-r;){let r=(t+n)/2,s=e(r);s<=0?(t=r,a=s):(n=r,o=s)}return t}(n=>{let r=(n-this.x)/(e-this.t),o=1/(e-this.t);return 2*this.gamma*o*(r-this.v)-1/(n-a)+1/(t-n)},a,t),s=(o-this.x)/(e-this.t);return this.v=this.alpha*this.v+(1-this.alpha)*s,this.x=Math.max(o,this.x),this.t=e,this.smoother_done=this.model_done&&this.x>=this.text.length,this.stats.push({t:e,x:o,v:s,min_chars:a,max_chars:t}),this.text.slice(0,this.x)}onMessage(e){this._set_raw_completion(e.completion,null!==e.stop)}async task(e,t){for(;!this.smoother_done&&!t.aborted;){let t=this._get_smoothed_completion();e(t),await new Promise(e=>setTimeout(e,10))}}constructor(){this.alpha=.99,this.gamma=1e-5,this.v=100,this.x=0,this.t=0,this.arrivals=[[-9999,0]],this.start=0,this.text="",this.model_done=!1,this.smoother_done=!1,this.stats=[]}};function resolveStreamCompletionEndpoint(e,t,n){switch(e){case 1:return"/api/stream_completion";case 2:return"/api/append_message";case 3:return"/api/retry_message";case 4:if(void 0===t||void 0===n)throw Error("Missing org uuid or conversation uuid");return"/api/organizations/".concat(t,"/chat_conversations/").concat(n,"/completion");case 5:if(void 0===t||void 0===n)throw Error("Missing org uuid or conversation uuid");return"/api/organizations/".concat(t,"/chat_conversations/").concat(n,"/retry_completion");case 6:if(void 0===t)throw Error("Missing org uuid");return"/api/organizations/".concat(t,"/stream_completion");default:throw Error("Invalid endpoint")}}async function streamCompletionDeprecated(e){let{endpoint:t,orgUuid:n,conversationUuid:r,body:a,onCompletion:o,abortController:s,completion:l}=e,c=new Smoother,d=c.task(o,s.signal),m=null,h="",f=(0,u.L)(resolveStreamCompletionEndpoint(t,n,r),{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream"},body:JSON.stringify({completion:l,...a}),openWhenHidden:!0,signal:s.signal,async onopen(e){var t;if(!(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes(u.a))){let t=await e.text(),n={};try{n=JSON.parse(t)}catch(e){}throw(0,i.fT)(e.status,n,"Failed to fetch")}},onmessage(e){let t=JSON.parse(e.data);if("error"in t)throw(0,i.fT)(0,t,"Streaming error");if(m=t,void 0===t.completion)throw Error("Unexpected message received when streaming: ".concat(e.data));h+=t.completion,c.onMessage(t)},onclose(){c.model_done=!0},onerror(e){throw c.model_done=!0,c.smoother_done=!0,e}});return await Promise.all([f,d]),Object.assign({},m,{completion:h})}async function streamCompletionDirect(e){let{endpoint:t,orgUuid:n,conversationUuid:r,body:a,onCompletion:o,abortController:s,completion:c}=e,d=new Smoother,m=d.task(o,s.signal),h=null,f="",g=JSON.stringify({...c,...a,text:void 0,organization_uuid:void 0,conversation_uuid:void 0}),p=(0,u.L)(resolveStreamCompletionEndpoint(t,n,r),{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream"},body:g,openWhenHidden:!0,signal:s.signal,async onopen(e){var t;if(!e.ok||!(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes(u.a))){let t=await e.text();s.abort();let n={};try{n=JSON.parse(t)}catch(e){}throw(0,i.fT)(e.status,n,"Failed to fetch")}},onmessage(e){switch(e.event){case"ping":default:return;case"error":throw(0,i.fT)(0,JSON.parse(e.data),"Streaming error");case"completion":{let t=JSON.parse(e.data);if(h=t,void 0===t.completion)throw Error("Unexpected message received when streaming: ".concat(e.data));f+=t.completion,d.onMessage(t)}}},onclose(){d.model_done=!0},onerror(e){throw e instanceof i.Hx&&529===e.statusCode||(0,l.Tb)(e),d.model_done=!0,d.smoother_done=!0,e}});return await Promise.all([p,m]),Object.assign({},h,{completion:f})}async function streamCompletion(e){let{endpoint:t,orgUuid:n,conversationUuid:r,body:a,onCompletion:o,abortController:s,completion:i}=e;return!function(e){switch(e){case 6:case 4:case 5:return!0;default:return!1}}(t)?await streamCompletionDeprecated({endpoint:t,orgUuid:n,conversationUuid:r,body:a,onCompletion:o,abortController:s,completion:i}):await streamCompletionDirect({endpoint:t,orgUuid:n,conversationUuid:r,body:a,onCompletion:o,abortController:s,completion:i})}(r=o||(o={}))[r.STREAM_COMPLETION_NEXTJS=1]="STREAM_COMPLETION_NEXTJS",r[r.APPEND_MESSAGE_WITH_COMPLETION_NEXTJS=2]="APPEND_MESSAGE_WITH_COMPLETION_NEXTJS",r[r.RETRY_MESSAGE_WITH_COMPLETION_NEXTJS=3]="RETRY_MESSAGE_WITH_COMPLETION_NEXTJS",r[r.APPEND_MESSAGE_WITH_COMPLETION=4]="APPEND_MESSAGE_WITH_COMPLETION",r[r.RETRY_MESSAGE_WITH_COMPLETION=5]="RETRY_MESSAGE_WITH_COMPLETION",r[r.STREAM_COMPLETION=6]="STREAM_COMPLETION",(a=s||(s={})).Ping="ping",a.Completion="completion",a.Error="error"},85479:function(e,t,n){n.d(t,{DM:function(){return useRetryStream},TQ:function(){return useAppendStream},ZP:function(){return useCompletionStream},hH:function(){return MultiStreamContextProvider},wN:function(){return useCompletionStreamModel}});var r=n(27573),a=n(93352),o=n(22809),s=n(45440),i=n(38348),u=n(37653),l=n(99865),c=n(10040),d=n(78104),m=n.n(d),h=n(95989),f=n(2056),g=n.n(f),p=n(32859),_=n(7653),v=n(83127),x=n(58355),E=n(90274),S=n(79929),C=n(94786);let ContactInstructions=()=>{let e=(0,a.Zx)(),{account:t}=(0,o.t)();return e?(0,r.jsx)("a",{href:(0,x.CE)((null==t?void 0:t.email_address)||"",u.m),className:"font-bold underline",target:"_blank",rel:"noreferrer",children:"get notified when paid plans are available"}):(0,r.jsxs)(r.Fragment,{children:["contact"," ",(0,r.jsx)(g(),{href:"mailto:sales@anthropic.com",children:"sales@anthropic.com"})," if you would be interested in upgrading to a paid version of Claude"]})},y=(0,_.createContext)([null,null]);function MultiStreamContextProvider(e){let{children:t}=e,n=(0,_.useState)({});return(0,r.jsx)(y.Provider,{value:n,children:t})}function useRetryStream(e){let{activeOrganization:t}=(0,o.t)(),n=null==t?void 0:t.uuid,r=(0,c.useQueryClient)(),{onIncrementalCompletion:a,onStreamCompleted:s}=(0,C.g)(),{value:i}=(0,v.useGate)("direct_completion_endpoint"),u=useCompletionStream({conversationUUID:e,endpoint:i?E.Cb.RETRY_MESSAGE_WITH_COMPLETION:E.Cb.RETRY_MESSAGE_WITH_COMPLETION_NEXTJS,onIncrementalCompletion:a,onStreamCompleted:s}),d=(0,_.useCallback)(async()=>{let t=[l.ph,{orgUUID:n},{uuid:e}];r.setQueryData(t,e=>{if(!e)return;let t=m()(e.chat_messages,"index");if(!t)return e;let n=e.chat_messages.filter(e=>e.uuid!==t.uuid);return{...e,chat_messages:[...n,{text:"",created_at:new Date().toISOString(),is_edited:!1,sender:"assistant",attachments:[],index:t.index}]}}),r.setQueryDefaults(t,{staleTime:1/0});try{await u.runStream({prompt:"",attachments:[]})}finally{r.setQueryDefaults(t,{staleTime:0})}},[e,n,r,u]);return{...u,runStream:d}}function useAppendStream(e){let{activeOrganization:t}=(0,o.t)(),n=null==t?void 0:t.uuid,r=(0,c.useQueryClient)(),{onIncrementalCompletion:a,onStreamCompleted:s}=(0,C.g)(),{value:i}=(0,v.useGate)("direct_completion_endpoint"),u=useCompletionStream({conversationUUID:e,endpoint:i?E.Cb.APPEND_MESSAGE_WITH_COMPLETION:E.Cb.APPEND_MESSAGE_WITH_COMPLETION_NEXTJS,onIncrementalCompletion:a,onStreamCompleted:s}),d=(0,_.useCallback)(async t=>{let{prompt:a,attachments:o,messageTokenCount:s,rethrowErrors:i=!1}=t,c=[l.ph,{orgUUID:n},{uuid:e}];r.setQueryData(c,e=>{var t,n;if(!e)return;let r=null!==(n=null===(t=m()(e.chat_messages,"index"))||void 0===t?void 0:t.index)&&void 0!==n?n:-1;return{...e,chat_messages:[...e.chat_messages,{text:a,created_at:new Date().toISOString(),is_edited:!1,sender:"human",attachments:o,index:r+1},{text:"",created_at:new Date().toISOString(),is_edited:!1,sender:"assistant",attachments:[],index:r+2}]}}),r.setQueryDefaults(c,{staleTime:1/0});try{await u.runStream({prompt:a,attachments:o,messageTokenCount:s,rethrowErrors:i})}finally{r.setQueryDefaults(c,{staleTime:0})}},[e,n,r,u]);return{...u,runStream:d}}let useCompletionStreamModel=()=>{let e=(0,p.useSearchParams)(),t=null==e?void 0:e.get("model"),{config:n}=(0,v.useConfig)("console_default_model");return t||n.get("model",void 0)};function useCompletionStream(e){let{conversationUUID:t,endpoint:n,onIncrementalCompletion:a,onStreamCompleted:u}=e,{activeOrganization:l}=(0,o.t)(),c=(0,o.ZJ)(),{customSystemPrompt:d}=(0,S.h)(),{context:m,clearContext:f,setContext:g}=function(e){let[t,n]=(0,_.useContext)(y),[r,a]=(0,_.useState)(),o=(0,_.useCallback)(()=>{n?n(t=>{let n={...t};return delete n[e],n}):a(void 0)},[e,n]),s=(0,_.useCallback)(t=>{n?n(n=>({...n,[e]:t})):a(t)},[e,n]);return{context:t?t[e]:r,clearContext:o,setContext:s}}(t),v=(0,p.useSearchParams)(),x=null==v?void 0:v.get("t"),C=useCompletionStreamModel(),{addError:T}=(0,s.e)(),w=(0,_.useCallback)(async e=>{await (null==u?void 0:u(t,e)),f()},[u,t,f]),P=(0,_.useCallback)(e=>{if(!(e instanceof i.Hx))return T("We couldn't connect to Claude. Please check your network connection and try again.");if("rate_limit_error"===e.type){if("too_many_completions"===e.extra.code&&"number"==typeof e.extra.resets_at){let t=h.ou.fromSeconds(e.extra.resets_at);return c?T((0,r.jsxs)("p",{children:["You've reached the limit of Claude conversations until"," ",t.toFormat("h a"),". Please try again then."]})):T((0,r.jsxs)("p",{children:["You've reached the limit of free Claude conversations until"," ",t.toFormat("h a"),". Please try again then, or"," ",(0,r.jsx)(ContactInstructions,{}),"."]}))}return c?T((0,r.jsx)("p",{children:"You've reached the limit of simultaneous conversations with Claude. Please wait before trying again."})):T((0,r.jsxs)("p",{children:["You've reached the limit of simultaneous conversations with Claude. Please wait before trying again, or"," ",(0,r.jsx)(ContactInstructions,{}),"."]}))}return"not_found_error"===e.type?T((0,r.jsx)("p",{children:"Claude model version not found."})):"overloaded_error"===e.type?c?T((0,r.jsx)("p",{children:"Due to unexpected capacity constraints, Claude is unable to respond to your message. Please try again soon."})):T((0,r.jsxs)("p",{children:["Due to unexpected capacity constraints, Claude is unable to respond to your message. Please try again soon, or ",(0,r.jsx)(ContactInstructions,{}),"."]})):"invalid_request_error"===e.type&&"read_only_mode"===e.extra.code?T((0,r.jsxs)("p",{children:["Due to capacity constraints, chatting with Claude is currently not available. Please try again in a little while, or"," ",(0,r.jsx)(ContactInstructions,{}),"."]})):T(e)},[T,c]),b=(0,_.useCallback)(async e=>{let{prompt:r,attachments:o,messageTokenCount:s,rethrowErrors:i=!1}=e;if(m)return;if(!l)throw Error("Cannot stream without an organization");let u=new AbortController;g({controller:u,sentMessageTokenCount:s});let c={prompt:r,timezone:h.ou.local().zoneName||void 0};d&&(c.custom_system_prompt=d),C&&"string"==typeof C&&(c.model=C),"string"==typeof x&&(c.temperature=parseInt(x));let f="",p=null;try{p=await (0,E.Lz)({endpoint:n,orgUuid:l.uuid,conversationUuid:t,body:{organization_uuid:l.uuid,conversation_uuid:t,text:r,attachments:o},onCompletion:e=>{a(t,e.substring(f.length)),f=e},abortController:u,completion:c})}catch(e){if(P(e),i)throw e}finally{await w(p)}return f},[m,l,g,C,x,a,t,n,P,w,d]),M=(0,_.useCallback)(()=>{m&&(m.controller.abort(),w(null))},[m,w]);return{runStream:b,isStreaming:!!m,sentMessageTokenCount:null==m?void 0:m.sentMessageTokenCount,abortStream:M}}},79929:function(e,t,n){n.d(t,{h:function(){return useCustomSystemPromptStore}});var r=n(61501),a=n(7653);let useCustomSystemPromptStore=()=>{let e=(0,r.useQuery)(["customSystemPrompt"],()=>localStorage.getItem("customSystemPrompt")||"",{initialData:""}),t=e.data||"",n=(0,a.useCallback)(t=>{let n=t;"function"==typeof t&&(n=t(e.data||"")),localStorage.setItem("customSystemPrompt",n),e.refetch()},[e]);return{customSystemPrompt:t,setCustomSystemPrompt:n}}},94786:function(e,t,n){n.d(t,{g:function(){return useUpdateMessageCache}});var r=n(22809),a=n(99865),o=n(10040),s=n(78104),i=n.n(s),u=n(7653);function useUpdateMessageCache(){let{activeOrganization:e}=(0,r.t)(),t=(0,o.useQueryClient)(),n=(0,u.useCallback)((n,r)=>{t.setQueryData([a.ph,{orgUUID:null==e?void 0:e.uuid},{uuid:n}],e=>{if(!e)return e;let t=e.chat_messages,n=i()(t,"index");return(null==n?void 0:n.sender)==="assistant"&&(t=t.map(e=>e.index===n.index?{...e,text:e.text+r}:e)),{...e,chat_messages:t}})},[null==e?void 0:e.uuid,t]),s=(0,u.useCallback)(async(n,r)=>{let o=null==e?void 0:e.uuid,s=[a.ph,{orgUUID:o},{uuid:n}];r?(t.setQueryData([a.tv,{orgUUID:o}],e=>{if(!e)return;let t=e.find(e=>e.uuid===n);return t?[{...t,updated_at:new Date().toISOString()},...e.filter(e=>e.uuid!==n)]:e}),await t.invalidateQueries(s)):(t.setQueryData(s,e=>{if(e)return{...e,chat_messages:e.chat_messages.slice(0,-2)}}),t.invalidateQueries(s));let i=null==r?void 0:r.messageLimit;i&&o&&t.setQueryData([a.aY],e=>e&&e.success?{...e,messageLimits:{...e.messageLimits,[o]:i}}:e)},[null==e?void 0:e.uuid,t]);return{onIncrementalCompletion:n,onStreamCompleted:s}}},45440:function(e,t,n){n.d(t,{e:function(){return useToasts},i:function(){return ErrorsProvider}});var r=n(27573),a=n(7653);let o=(0,a.createContext)(void 0);function ErrorsProvider(e){let{children:t}=e,n=(0,a.useRef)(1),[s,i]=(0,a.useState)([]),u=(0,a.useCallback)(e=>{i(t=>[...t,{id:n.current++,message:e instanceof Error?e.message:e,toastType:"error"}])},[]),l=(0,a.useCallback)(e=>{i(t=>[...t,{id:n.current++,message:e instanceof Error?e.message:e,toastType:"success"}])},[]),c=(0,a.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e))},[]),d=(0,a.useMemo)(()=>({toasts:s,addError:u,addSuccess:l,clearToast:c}),[s,u,l,c]);return(0,r.jsx)(o.Provider,{value:d,children:t})}function useToasts(){let e=(0,a.useContext)(o);if(!e)throw Error("Must be called within ErrorsProvider");return e}},37653:function(e,t,n){n.d(t,{g:function(){return a},m:function(){return r}});let r=["https://forms.gle/r2yBoWVmbDeru9jY7"],a="https://support.anthropic.com/en/articles/8324991-about-claude-pro-usage"},69507:function(e,t,n){function sanitizeHumanText(e){return e.replaceAll("\n\nHuman:","\n\nH:").replaceAll("\n\nAssistant:","\n\nA:")}function longStringBlurb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;if(e.length<=t)return e;let n=Math.ceil(t/2);return"".concat(e.substring(0,n),"\n\n  [...]\n\n  ").concat(e.substring(e.length-n))}function makeFileAttachmentsPromptTagParts(e){let{attachments:t,blurbOnly:n,useLegacyFormat:r}=e;if(r){let e=t.map(e=>(function(e){let{attachment:t,blurbOnly:n}=e,r=n?longStringBlurb(t.extracted_content):t.extracted_content;return'<file-attachment-contents filename="'.concat(encodeURIComponent(t.file_name),'">\n').concat(r,"\n</file-attachment-contents>")})({attachment:e,blurbOnly:n}));return e}{if(0===t.length)return[];let e=["<documents>"];for(let[r,a]of t.entries())e.push(function(e){let{attachment:t,index:n,blurbOnly:r}=e,a=r?longStringBlurb(t.extracted_content):t.extracted_content;return'<document index="'.concat(n,'">\n<source>').concat(t.file_name,"</source>\n<document_content>").concat(a,"</document_content>\n</document>")}({attachment:a,index:r+1,blurbOnly:n}));return e.push("</documents>"),e}}n.d(t,{HM:function(){return makeFileAttachmentsPromptTagParts},V9:function(){return messagesToPromptHelper},iy:function(){return longStringBlurb}});let messageToPromptText=e=>{let{message:t,useLegacyFormat:n}=e,r=t.attachments||[];if(""===t.text.trim()&&1===r.length)return sanitizeHumanText(r[0].extracted_content);let a=r.length?[...makeFileAttachmentsPromptTagParts({attachments:r,useLegacyFormat:n}),"",t.text].join("\n"):t.text;return"human"===t.sender?sanitizeHumanText(a):a};function messagesToPromptHelper(e){let{messages:t,prependSystemPrompt:n,systemPrompt:r,useLegacyDocumentFormat:a}=e,o=t.map(e=>{let t="human"===e.sender?"Human":"Assistant";return"".concat(t,": ").concat(messageToPromptText({message:e,useLegacyFormat:a}))}).join("\n\n");return"".concat(n?r:"","\n\n").concat(o,"\n\nAssistant:")}}}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[283],{32338:function(e){e.exports=function(e,t){return e>t}},78104:function(e,t,r){var n=r(26917),u=r(32338),i=r(89308);e.exports=function(e,t){return e&&e.length?n(e,i(t,2),u):void 0}},448:function(e,t,r){Promise.resolve().then(r.bind(r,13001))},13001:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Layout}});var n=r(27573),u=r(85479),i=r(22809);function Layout(e){var t;let{children:r}=e,{activeOrganization:o}=(0,i.t)(),s=(null==o?void 0:null===(t=o.settings)||void 0===t?void 0:t.claude_console_privacy)==="zero_retention";return s?r:(0,n.jsx)(u.hH,{children:r})}},86211:function(e,t,r){"use strict";r.d(t,{Ne:function(){return useOptimisticApiMutation},WE:function(){return useApiQuery},uC:function(){return useApiMutation}});var n=r(38348),u=r(39547),i=r(40604),o=r(61501),s=r(10040),a=r(7653),c=r(72623);function useFetch(e){let{setUpdateType:t}=(0,c.m)();return(0,a.useCallback)(async(r,i)=>{let o=await fetch(r,{...i,headers:{"anthropic-client-sha":"405ee5562c871142f58392b80c90597a313e5487","anthropic-client-version":"1",...i.headers}}),s=o.headers.get("anthropic-client-update");s&&["prompt","force"].includes(s)&&t(s);let a=await o.text(),c={error:{type:"api_error",message:a}};try{("DELETE"!==i.method||a.length>0)&&(c=JSON.parse(a))}catch(e){(0,u.uT)("Got invalid JSON from NextJS response",{extra:{text:a,status:o.status}})}if(!o.ok)throw(0,n.fT)(o.status,c,e);return c},[e,t])}let useApiMutation=(e,t,r)=>{let{transformVariables:n,enabled:u=!0,...o}=r||{},s=useFetch("Mutation error"),{mutate:c,...l}=(0,i.useMutation)({mutationFn:async r=>{let u;u="function"==typeof e?e(r):e;let i=n?n(r):r,o=await s(u,{method:t,headers:{"Content-Type":"application/json"},body:i?JSON.stringify(i):void 0});return o},...o}),d=(0,a.useCallback)(e=>{u&&c(e)},[c,u]);return{mutate:d,...l}},useApiQuery=(e,t)=>{let r=useFetch("Query error");return(0,o.useQuery)({queryKey:[e],queryFn:async()=>{let t=await r(e,{method:"GET",headers:{"Content-Type":"application/json"}});return t},retry:!1,...t})};function useOptimisticApiMutation(e,t,r,n){let u=(0,s.useQueryClient)(),{queryKey:i,...o}=n;return useApiMutation(e,t,{async onMutate(e){await u.cancelQueries({queryKey:i});let t=u.getQueryData(i);return u.setQueryData(i,t=>r(e,t)),{previousValue:t}},onError(e,t,r){(null==r?void 0:r.previousValue)&&u.setQueryData(i,r.previousValue)},...o})}},72623:function(e,t,r){"use strict";r.d(t,{F:function(){return ClientUpdateProvider},m:function(){return useClientUpdate}});var n=r(27573),u=r(71036),i=r(7653);let o=(0,i.createContext)(null),s="undefined"!=typeof navigator&&"serviceWorker"in navigator,getWorkbox=()=>"workbox"in window&&s?window.workbox:null,updateWorkbox=e=>{let run=async()=>{try{await e.update()}catch(e){}};run()};function ClientUpdateProvider(e){let{children:t}=e,[r,a]=(0,i.useState)(null);(0,i.useEffect)(()=>{(0,u.yG)()&&s&&(async()=>{let e=await navigator.serviceWorker.getRegistrations();0!==e.length&&(console.warn("Found ".concat(e.length," service worker(s). This was probably from running a production build at this origin. Unregistering.")),e.forEach(e=>void e.unregister()))})()},[]),(0,i.useEffect)(()=>{let e=getWorkbox();e&&r&&((async()=>{let e=await window.caches.keys();await Promise.all(e.map(e=>caches.delete(e)))})(),updateWorkbox(e))},[r]),(0,i.useEffect)(()=>{let e=getWorkbox();if(!e)return;let t=window.setInterval(()=>{updateWorkbox(e)},36e5);return()=>{window.clearInterval(t)}},[]);let c=(0,i.useMemo)(()=>({updateType:r,setUpdateType:a}),[r]);return(0,n.jsx)(o.Provider,{value:c,children:t})}function useClientUpdate(){let e=(0,i.useContext)(o);if(!e)throw Error("Must be called from within ClientUpdateProvider");return e}},93352:function(e,t,r){"use strict";r.d(t,{Pc:function(){return ConfigurationProvider},Zx:function(){return useIsClaudeDot},mX:function(){return useConfiguration}});var n=r(27573),u=r(7653);let i=(0,u.createContext)(void 0),ConfigurationProvider=e=>{let{config:t,children:r}=e;return(0,n.jsx)(i.Provider,{value:t,children:r})},useConfiguration=()=>{let e=(0,u.useContext)(i);if(!e)throw Error("useConfiguration must be called from within ConfigurationProvider");return e},useIsClaudeDot=()=>{let{applicationType:e}=useConfiguration();return"claude-dot"===e}},22809:function(e,t,r){"use strict";r.d(t,{IU:function(){return useUsagePaused},Q6:function(){return CurrentAccountProvider},ZJ:function(){return useHasProSubscription},oD:function(){return useCurrentAccountQuery},t:function(){return useCurrentAccount}});var n=r(27573),u=r(71036),i=r(99865),o=r(39547),s=r(44637),a=r.n(s),c=r(32859),l=r(7653),d=r(58372),f=r(86211),p=r(93352),v=r(19981);let h="lastActiveOrg",m=(0,l.createContext)(null),CurrentAccountProvider=e=>{let{children:t}=e,[r,i]=(0,l.useState)(),{data:s,isFetching:f,refetch:g}=useCurrentAccountQuery(),y=(0,v.K)();(0,l.useEffect)(()=>{if(!(null==s?void 0:s.success))return;let e=s.account;o.av({id:e.uuid});let t="none";for(let r of["commercial_use","claude_pro","api"])if(e.memberships.some(e=>e.organization.capabilities.includes(r))){t="commercial_use";break}y.identify(s.account.uuid,{plan:t})},[s,y]);let b=(0,c.usePathname)();(0,l.useEffect)(()=>{!(0,u.yG)()&&(null==s?void 0:s.success)&&b&&y.page(b)},[b,y,s]),(0,l.useEffect)(()=>{if(r)try{window.localStorage.setItem(h,r)}catch(e){}},[r]);let w=(0,d.o)();(0,l.useEffect)(()=>{!(0,u.yG)()&&(null==s?void 0:s.success)&&w.boot({hideDefaultLauncher:!0,userId:s.account.uuid,email:s.account.email_address,name:s.account.full_name,userHash:s.intercomAccountHash})},[w,s]);let _=(0,p.Zx)(),C=(0,c.useSearchParams)(),x=C.get("organization_id"),E=(0,l.useMemo)(()=>{let e;if(!(null==s?void 0:s.success))return;let t=_?"chat":"api",n=s.account.memberships.map(e=>e.organization).filter(e=>e.capabilities.includes(t));if(r){let e=n.find(e=>e.uuid===r);if(e)return e}if(x&&(e=n.find(e=>e.uuid===x)),!e)try{let t=window.localStorage.getItem(h);e=n.find(e=>e.uuid===t)}catch(e){}return e||(e=a()(n,"name")),e&&i(e.uuid),e},[s,r,x,_]);(0,l.useEffect)(()=>{E&&w.update({customAttributes:{paidAccount:E.capabilities.includes("commercial_use"),claudePro:E.capabilities.includes("claude_pro"),orgUUID:E.uuid,orgName:E.name,orgCapabilities:E.capabilities.join(",")}})},[w,E]);let P=(0,l.useMemo)(()=>({account:(null==s?void 0:s.success)?s.account:void 0,messageLimit:(null==s?void 0:s.success)&&E?s.messageLimits[E.uuid]:void 0,activeOrganization:E,setActiveOrganizationUUID:i,isLoading:f,isLoggedOut:!f&&(null==s?void 0:s.success)===!1,refetch:async()=>{var e;let t=await g();if(null===(e=t.data)||void 0===e?void 0:e.success)return t.data.account}}),[s,E,f,g]);return(0,n.jsx)(m.Provider,{value:P,children:t})},useCurrentAccountQuery=()=>(0,f.WE)("/api/auth/current_account",{queryKey:[i.aY],staleTime:1/0}),useCurrentAccount=()=>{let e=(0,l.useContext)(m);if(!e)throw Error("Must call inside CurrentAccountProvider");return e},useHasProSubscription=()=>{let{activeOrganization:e}=useCurrentAccount();return null==e?void 0:e.capabilities.includes("claude_pro")},useUsagePaused=()=>{let{activeOrganization:e}=useCurrentAccount();return null!=e&&!!e.billable_usage_paused_until&&new Date(e.billable_usage_paused_until)>new Date}},19981:function(e,t,r){"use strict";r.d(t,{K:function(){return useSegment}});var n=r(27376),u=r(93352);let i=null,useSegment=()=>{let{segmentKey:e,segmentCdnHost:t,segmentApiHost:r}=(0,u.mX)();return i||(i=n.b.load({writeKey:e,cdnURL:"https://".concat(t)},{disableClientPersistence:!0,integrations:{"Segment.io":{apiHost:"".concat(r,"/v1"),protocol:"https"}}})),i}},38348:function(e,t,r){"use strict";r.d(t,{Hx:function(){return APIError},fT:function(){return errorFromResponse}});let APIError=class APIError extends Error{constructor(e,t,r,n){super(e),this.type=t,this.statusCode=r,this.extra=n}};function errorFromResponse(e,t,r){if(t&&"object"==typeof t&&"error"in t){let r=t.error,{message:n,type:u,...i}=r;return new APIError(n,u,e,i)}return new APIError(r,"api_error",e,t||{})}},71036:function(e,t,r){"use strict";r.d(t,{yG:function(){return isDevelopment}}),r(68571);let isDevelopment=()=>!1},99865:function(e,t,r){"use strict";r.d(t,{BB:function(){return s},I_:function(){return o},L0:function(){return h},QU:function(){return d},RK:function(){return f},aY:function(){return u},dv:function(){return v},eW:function(){return l},mm:function(){return i},nM:function(){return n},ph:function(){return c},tv:function(){return a},xp:function(){return p}});let n="api_key_list",u="current_account",i="org",o="org_members",s="org_invites",a="chat_conversation_list",c="chat_conversation",l="account_statsig",d="subscription_details",f="invoice_list",p="workbench_list_prompts",v="workbench_get_prompt",h="workbench_list_revisions"}},function(e){e.O(0,[2044,4454,6378,3127,2056,9711,4637,1328,5989,484,5479,1293,1362,3216,1744],function(){return e(e.s=448)}),_N_E=e.O()}]);